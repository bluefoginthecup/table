<!doctype html>
<html lang="ko">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>3D Simul Table (Skeleton)</title>
  <link rel="stylesheet" href="./styles/styles.css" />
  <!-- 개발 단계용: ESM CDN import map. 번들링하면 제거 가능 -->
  <script type="importmap">
  {
    "imports": {
      "three": "https://esm.sh/three@0.160.0",
      "three/addons/": "https://esm.sh/three@0.160.0/examples/jsm/"
    }
  }
  </script>
</head>
<body>
  <aside class="side">
    <h1>3D Simul Table</h1>
    <div class="controls">
    
      
      <label>테이블 형태
          <select id="tableShape">
            <option value="rect" selected>사각(다리 4개)</option>
            <option value="round">원탁(중앙 기둥)</option>
          </select>
      </label>

    
      <label>테이블 폭(cm) <input id="wid" type="number" value="90" /></label>
      <label>테이블 길이(cm) <input id="len" type="number" value="200" /></label>
      <label>테이블 높이(cm) <input id="hei" type="number" value="75" /></label>
      <label>러너 폭(cm) <input id="runnerWid" type="number" value="40" /></label>
      <label>러너 길이(cm) <input id="runnerLen" type="number" value="250" /></label>
      <button id="applyBtn">적용</button>
      <button id="resetBtn">리셋</button>
    </div>
    <div class="tests">
      <button id="runTestsBtn">Self Tests</button>
      <ul id="testList"></ul>
    </div>
  </aside>
  <main class="stage">
    <div id="app"></div>
  </main>
  <script type="module" src="./src/main.js">
  applyBtn.addEventListener('click', () => {
    // 1) 계산 결과 (product)
    const prodRes = calculate(); // {type:'runner'|'rectcloth'|'roundcloth', ...}

    // 2) 현재 테이블 입력 상태 (table)
    const table = (tableShape.value === 'rect')
      ? { shape: 'rect', width: Number(tblW.value||0), length: Number(tblL.value||0) }
      : { shape: 'round', diameter: Number(tblD.value||0) };

    // 3) 이벤트 디스패치 (메인 루프가 청취)
    window.dispatchEvent(new CustomEvent('ui:apply', {
      detail: {
        table,
        product: prodRes
      }
    }));
  });
    
    </script>
</body>
</html>
